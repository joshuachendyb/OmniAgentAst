# MDview目录整理总结

**创建时间**: 2026-02-12 12:30:47
**整理日期**: 2026-02-12
**工作区**: D:\2bktest\MDview\

---

## 一、整理背景与目的

### 1.1 背景

在长期项目开发过程中，MDview工作区积累了大量文件，包括：
- 项目源代码和构建产物
- 测试用例和测试报告
- 开发文档和技术文档
- 调试笔记和工作日志
- 历史遗留的废弃文件

随着项目规模扩大，目录结构逐渐混乱，亟需系统整理。

### 1.2 目的

本次整理的核心目标包括：
- 建立清晰、逻辑合理的目录结构
-版本控制做好准备 为后续Git
- 明确各目录的用途和管理规范
- 清理历史遗留的废弃文件
- 提升项目可维护性和协作效率

---

## 二、整理前的目录状态

### 2.1 整理前的主要问题

| 问题类型 | 具体表现 | 影响 |
|---------|---------|------|
| **文件分散** | 相关文件分散在多处 | 查找困难，协作不便 |
| **命名混乱** | 临时文件、备份文件未规范管理 | 难以区分重要文件 |
| **遗留文件** | 废弃目录和测试产物未清理 | 占用空间，影响判断 |
| **重复文件** | package.json等文件在多处存在 | 版本不一致风险 |
| **结构模糊** | 根目录文件过多，职责不清 | 新成员难以理解项目 |

### 2.2 整理前的主要目录

```
D:\2bktest\MDview\
├── node_modules/           # 根目录的node_modules
├── package.json           # 根目录的package.json
├── package-lock.json       # 根目录的lock文件
├── version.txt            # 版本文件
├── upload_to_github.bat   # 上传脚本
├── 废弃的/                # 历史废弃目录
│   ├── dist/
│   └── TestCode/
├── gobuild/               # Go+Wails架构
│   └── release_20260203_v2.0.0/
├── rustbuild/             # Rust+Tauri架构
├── react-template/        # React模板
├── tools/                 # 工具目录
├── AI工具研究/            # AI工具研究
├── AI编程之路故事/        # 学习故事
├── 自研Skill/             # 自研Skill插件
└── MermaidReader/         # MermaidReader主项目
```

---

## 三、整理后的目录结构

### 3.1 最终目录结构

```
D:\2bktest\MDview\
├── MermaidReader/              # MermaidReader主项目
│   ├── productDoc/             # 产品文档（5个文件）
│   ├── devDoc/                 # 开发文档（16+个文件）
│   ├── notes/                  # 调试笔记（12个文件）
│   ├── tests/                  # 测试相关
│   │   ├── node_modules/       # 测试依赖
│   │   ├── legacy/             # 历史测试代码
│   │   ├── 1-BUG-STANDARD.md   # BUG标准
│   │   └── 2-BUG-修复报告.md   # BUG修复报告
│   ├── web/release/           # Web发布版本
│   │   ├── v0.0.5/            # v0.0.5版本
│   │   ├── v1.2/              # v1.2版本
│   │   └── v1.2-dark-mode/    # v1.2暗黑模式版本
│   ├── gobuild/               # Go+Wails架构
│   │   ├── archives/          # 归档zip文件
│   │   ├── backup/            # 版本备份（50+目录）
│   │   └── *.go, *.html等     # 源代码
│   └── rustbuild/             # Rust+Tauri架构（保持不变）
├── AI工具研究/                 # AI工具研究（保持不变）
├── AI编程之路故事/             # 学习故事（保持不变）
├── 自研Skill/                  # 自研Skill插件（保持不变）
└── OpenCode插件安装与TUI同步经验.md  # 插件安装经验文档
```

### 3.2 目录职责说明

| 目录名称 | 职责 | 包含内容 |
|---------|------|---------|
| **productDoc/** | 产品文档 | 需求分析、用户手册、产品说明等 |
| **devDoc/** | 开发文档 | 架构设计、详细设计、开发日志、技术文档 |
| **notes/** | 调试笔记 | 调试记录、问题分析、解决方案等 |
| **tests/** | 测试管理 | 测试用例、Bug管理、测试报告、测试依赖 |
| **web/release/** | Web发布 | 各版本Web构建产物 |
| **gobuild/** | Go架构 | Go+Wails项目源代码、构建产物、备份 |
| **rustbuild/** | Rust架构 | Rust+Tauri架构实现（独立演进） |

---

## 四、发现与成果

### 4.1 OpenCode插件使用发现

在整理过程中，深入研究了OpenCode插件系统，发现了以下重要信息：

#### 4.1.1 OpenCode两种运行模式

| 模式 | 运行时 | 插件存储位置 |
|------|-------|-------------|
| **Desktop版本** | Bun | `C:\Users\40968\.cache\opencode\node_modules\` |
| **TUI/CLI版本** | Node.js | `C:\Users\40968\.config\opencode\plugins\` |

#### 4.1.2 插件目录独立性问题

- Desktop版和TUI版的插件目录完全独立
- 在Desktop安装的插件不会自动同步到TUI版
- 必须手动复制插件到对应目录才能在两种模式间共享
- 这是一个重要的架构设计特点，需要用户注意

#### 4.1.3 配置文件关键点

- **配置键名必须是`plugin`（单数）**，不能使用`plugins`（复数）
- 使用`plugins`作为键名会导致OpenCode启动失败
- 文档中多处提到`plugins`，这是不正确的写法

#### 4.1.4 antigravity-auth插件版本要求

- 该插件必须使用具体的版本号（如`1.4.6`）
- 不能使用`@latest`这种动态版本号
- 使用`@latest`会导致版本解析失败

#### 4.1.5 session-backup插件配置限制

- session-backup插件依赖环境变量进行配置
- **Desktop版本不支持JSON格式的配置文件**
- TUI版本支持环境变量配置
- 这是一个版本差异的重要发现

### 4.2 创建的文档成果

| 文档名称 | 位置 | 说明 |
|---------|------|------|
| **OpenCode插件安装与TUI同步经验.md** | 工作区根目录 | 5000+字符，详细记录插件安装和TUI同步经验 |

### 4.3 创建的配置文件成果

| 文件名称 | 位置 | 说明 |
|---------|------|------|
| **.gitignore** | MermaidReader目录 | Git忽略规则配置 |

---

## 五、完成的整理工作

### 5.1 目录结构创建

| 操作 | 目标目录 | 说明 |
|------|---------|------|
| **创建** | `MermaidReader/productDoc/` | 产品文档目录，包含5个文件 |
| **创建** | `MermaidReader/devDoc/` | 开发文档目录，包含16+个文件 |
| **创建** | `MermaidReader/notes/` | 调试笔记目录，包含12个文件 |
| **创建** | `MermaidReader/tests/` | 测试管理目录 |
| **创建** | `MermaidReader/tests/node_modules/` | 测试依赖目录 |
| **创建** | `MermaidReader/tests/legacy/` | 历史测试代码目录 |
| **创建** | `MermaidReader/web/release/` | Web发布版本目录 |
| **创建** | `MermaidReader/gobuild/archives/` | Go架构归档目录 |

### 5.2 文件重新组织

| 操作 | 源位置 | 目标位置 |
|------|-------|---------|
| **移动** | `react-template/` | `AI工具研究/AgentationDemo/` |
| **移动** | `tools/` | `AI编程之路故事/工具/` |
| **移动** | `node_modules/` | `tests/node_modules/` |
| **移动** | `1-BUG-STANDARD.md` | `tests/` |
| **移动** | `2-BUG-修复报告.md` | `tests/` |
| **移动** | `废弃的/dist/*` | `web/release/v0.0.5/` |
| **移动** | `废弃的/TestCode/*` | `tests/legacy/` |
| **移动** | `gobuild/release_20260203_v2.0.0/*.md` | `notes/` |

### 5.3 清理工作

| 操作 | 目标 | 说明 |
|------|-----|------|
| **删除** | `废弃的/` | 包含废弃的dist和TestCode目录 |
| **删除** | `node_modules/` | 已移动到tests/目录 |
| **删除** | `package.json` | 根目录的重复文件 |
| **删除** | `package-lock.json` | 根目录的重复文件 |
| **删除** | `version.txt` | 根目录的版本文件 |
| **删除** | `upload_to_github.bat` | 过时的上传脚本 |
| **删除** | `nul` | 临时文件 |
| **删除** | `自研Skill/doc2md-skill" cp...` | 2个格式错误的文件 |

---

## 六、Git版本控制准备

### 6.1 .gitignore配置

已在`MermaidReader/`目录创建`.gitignore`文件，包含以下规则：

| 规则类型 | 匹配模式 | 说明 |
|---------|---------|------|
| **临时文件** | `*.log` | 日志文件 |
| **系统文件** | `.DS_Store` | macOS系统文件 |
| **临时文件** | `*.tmp` | 临时文件 |
| **备份文件** | `*.bak` | 备份文件 |
| **依赖目录** | `node_modules/` | Node.js依赖 |
| **构建产物** | `*.exe` | 可执行文件 |
| **构建产物** | `*.zip` | 压缩文件 |
| **编辑器** | `.vscode/` | VSCode配置 |
| **编辑器** | `.idea/` | JetBrains IDE配置 |

### 6.2 推荐的分支策略

根据`git使用规范.md`，建议采用以下分支策略：

| 分支类型 | 命名 | 说明 |
|---------|------|------|
| **主线分支** | `main` | Go+Wails架构主线 |
| **架构分支** | `arch/rust` | Rust+Tauri架构独立分支 |
| **功能分支** | `feature/xxx` | 新功能开发 |
| **修复分支** | `bugfix/xxx` | Bug修复 |

---

## 七、待完成的工作

### 7.1 Git仓库初始化

以下工作待用户确认后执行：

| 任务 | 说明 | 状态 |
|-----|------|------|
| **初始化Git仓库** | 在`MermaidReader/`目录执行`git init` | 待执行 |
| **创建main分支** | 创建并切换到main分支 | 待执行 |
| **创建arch/rust分支** | 创建Rust架构独立分支 | 待执行 |
| **首次提交** | 提交整理后的目录结构 | 待执行 |

### 7.2 用户验证项

| 验证项 | 说明 |
|-------|------|
| **目录结构** | 确认新的目录结构符合预期 |
| **文件位置** | 确认重要文件都在正确的位置 |
| **功能正常** | 确认项目功能未受影响 |
| **命名规范** | 确认目录和文件命名符合规范 |

---

## 八、经验教训

### 8.1 成功的经验

| 经验 | 说明 |
|-----|------|
| **先分析后动手** | 在整理前先了解文件的用途和关联 |
| **分类管理** | 按文档类型、功能类型进行分类 |
| **规范命名** | 使用清晰的目录和文件命名 |
| **及时记录** | 在`会话记录-2026-02-12.md`中持续记录进展 |

### 8.2 需要改进的地方

| 改进项 | 说明 |
|-------|------|
| **提前规划** | 应该在项目开始时就建立清晰的目录结构 |
| **定期清理** | 建立定期清理临时文件和废弃文件机制 |
| **文档同步** | 相关文档应该同步更新，避免信息不一致 |

### 8.3 建议的后续行动

| 行动 | 说明 |
|-----|------|
| **建立规范** | 在`AGENTS.md`中增加目录结构管理规范 |
| **定期检查** | 每月检查一次目录结构，及时清理 |
| **版本控制** | 尽快将项目纳入Git版本控制 |

---

## 九、总结

### 9.1 完成的主要工作

本次MDview目录整理工作完成的主要内容包括：

1. **分析了整理前的目录状态**，识别了主要问题
2. **设计了清晰的目录结构**，明确了各目录职责
3. **完成了文件重新组织**，将文件分类存放
4. **清理了历史遗留文件**，删除了废弃和重复文件
5. **发现了OpenCode插件的重要使用知识**
6. **创建了必要的文档和配置文件**

### 9.2 取得的主要成果

| 成果 | 说明 |
|-----|------|
| **清晰的目录结构** | 建立了productDoc、devDoc、notes、tests等规范目录 |
| **完善的文档** | 创建了`OpenCode插件安装与TUI同步经验.md` |
| **Git准备** | 创建了`.gitignore`文件，为版本控制做准备 |
| **知识积累** | 记录了OpenCode插件使用的关键知识 |

### 9.3 下一步行动

| 优先级 | 行动 | 说明 |
|-------|------|------|
| **高** | 用户验证 | 确认目录结构符合预期 |
| **高** | Git初始化 | 初始化Git仓库，创建分支 |
| **中** | 文档完善 | 完善项目文档和使用说明 |
| **中** | 规范建立 | 在`AGENTS.md`中增加目录管理规范 |

---

## 十、参考资料

| 文档名称 | 位置 | 说明 |
|---------|------|------|
| **会话记录-2026-02-12.md** | 工作区根目录 | 详细的会话操作记录 |
| **OpenCode插件安装与TUI同步经验.md** | 工作区根目录 | OpenCode插件使用经验 |
| **git使用规范.md** | D:\50RuleTool\规范与规则\ | Git使用规范文档 |
| **笔记及日志写入规则.md** | D:\50RuleTool\规范与规则\ | 笔记日志写入规范 |
| **软件代码迭代规范.md** | D:\50RuleTool\规范与规则\ | 代码迭代规范 |

---

**更新时间**: 2026-02-12 12:30:47
**版本**: v1.0
