# MMR 2.0.0版本升级计划需求文档

【版本】: v0.0.1 : 2026-02-13 15:03:06 : 首次创建
【版本】: v0.0.2 : 2026-02-13 18:35:00 : 新增需求16-MD文件更新主动刷新;精简文档结构
【版本】: v0.0.3 : 2026-02-13 22:00:00 : 删除第4章;第3章整合到第1章;修正文档规则
【版本】: v0.0.4 : 2026-02-13 22:15:00 : 合并1.1和1.2;强调版本号为软件版本号
【版本】: v0.0.5 : 2026-02-13 21:06:36 : 新增需求17-全自动化测试支持
【版本】: v0.0.6 : 2026-02-13 21:46:44 : 更新需求16-支持主动刷新和手动刷新按钮
【版本】: v0.0.7 : 2026-02-14 00:50:00 : 新增第四章-需求厘清总结，逐条分析17条需求
---

## 一、升级原则和要求

### 1.1 MMR版本信息（以下为软件版本号，非文档版本号）

- **这是MMR app的升级开发需求，不是原始需求**
- 需要围绕"好用"继续进行升级开发
- 之前的发布版本是2.0.0
- 后续依次是2.0.1, 2.0.2等等版本（Patch版本升级）
- 如需重大功能升级（第2位变更），需征得用户同意
- 版本升级规则：遵守版本号变更规范

### 1.2 开发要求

1. **先分析后开发**：需求分析完成前不开始编码
2. **分析阶段**：不建立分支
3. **开发阶段**：写代码时才建立分支
4. **分支命名**：之前建立的bugfix分支作为newfeature分支，或按商定名称
5. **后续工作**：务必按照分析结果进行开发

### 1.3 文档规则

- 遵循Git使用规范（docs:提交规范）
- 遵循代码检查方法
- 遵循软件代码迭代规范
- 遵循软件迭代代码备份规则
- 版本记录格式：【版本】: vX.Y.Z : 时间: 更新内容
- 每次修改在文档头部追加版本记录行（不删除旧版本记录）

### 1.4 其他要求

- 这是MMR的升级开发，不是原始需求
- 围绕"好用"进行升级开发
- 不要对需求发散性思维
- 版本升级规则要遵守
- 新分支暂时不建立，开发写代码时才建立
- 之前建立的bugfix分支作为newfeature分支
- 需求需分析排序后才能开发

---

## 二、原始需求列表

**按用户提供的顺序记录**：

1. 可以类似notepad点击MD文件直接启动mermaid阅读器，进入渲染预览显示

2. 可以在左侧列表显示最近选择或者点击阅读的MD文件，要包括文件名及完整路径名称

3. 最近列表上支持删除最近文件

4. 左侧列表可以折叠和展开

5. 需要增加显示版本历史新增或者删减，改变的功能信息

6. 调试信息窗口改成按钮开关查看

6.1 现在的MMR好像几个地方输出log或者错误查看信息，是不是可以合并在一起？比如就是log日志文件是不是可以呢？当然也可以分几个也可以的看侧重点怎么分配

7. MD文档支持图片功能

8. office的导出功能中，代码片段没有显示正确

9. 支持复制到剪切板的操作，支持我要发表文章给其他的比如头条，知乎，CSDN平台，微博

9.1 能不能支持通过接口去自动发送给他们呢

10. 支持源码显示，需要显示行号

11. 在解析mermaid出错的提示框，的存留时间值要缩短

12. 现在的出错信息我看有，出错提示框可以查看错误信息。预览页底部有错误信息，但是只是提供了解析mermaid的错误信息是不是还有其他类型调试板信息的类似log日志的文件显示？这三者之间有什么异同

13. 增加编辑功能，保存为MD或者txt格式

14. 是否可以支持word和PDF的阅读显示功能呢？

15. 界面需要做一下改变，需要怎么改变适应新的需求

16. MD文件的内容更新了，MMRreader能不能及时感知和主动刷新内容渲染新的内容呢，换一个方法有刷新按钮支持用户主动刷新也是可以的，或者两种方法都支持最好

17. 在进行MMR新版本开发的时候，问题修改和功能增加修改，能否支持自动执行全自动化测试呢？读取MD样例文件，检查显示是否正确？如果是修正错误问题，能否自动检测新修改后错误问题是否已改正？

---

## 四、需求厘清总结

### 第1条第1条原始需求

1）原始需求1描述：可以类似notepad点击MD文件直接启动mermaid阅读器，进入渲染预览显示

2）厘清的需求1描述：修改文件关联和安装脚本，让双击.md文件时自动启动MMR并直接渲染该文件。读取MD文件后，该文件需要自动添加到最近文件列表中。

3）本条需求分析：需要实现Windows文件关联注册（.md文件关联到MermaidReader.exe），在安装程序或首次启动时自动配置。技术实现涉及Windows注册表操作，关联双击事件直接启动应用并传入文件路径参数。难度：中等（注册表配置+安装脚本修改）。依赖：需求2（最近文件列表需要接收双击打开的文件）。

---

### 第1条第2条原始需求

1）原始需求2描述：可以在左侧列表显示最近选择或者点击阅读的MD文件，要包括文件名及完整路径名称

2）厘清的需求2描述：左侧列表已有，补充显示完整路径。修正后需求：最近列表数量从10个增加到30个左右（或无上限）；新增清除功能；完整路径显示方式：鼠标悬停在文件名上时显示tip窗口（2-3秒），或在文件名前/后添加小按钮点击显示完整路径。新增设置功能，配置tip窗口停留时间、各种功能开关等。

3）本条需求分析：需要扩展现有最近文件列表的数据容量，添加UI元素显示完整路径（tip弹窗或按钮）。技术要点：数据结构支持30条记录；tip窗口实现（鼠标悬停事件+定时显示）；设置页面新增相关配置项。难度：中等（数据结构调整+UI交互）。依赖：需求11（设置功能关联）。

---

### 第1条第3条原始需求

1）原始需求3描述：最近列表上支持删除最近文件

2）厘清的需求3描述：添加删除按钮或右键菜单。在左侧的最近文件列表中，为每个文件项添加删除按钮或在右键菜单中提供删除选项。

3）本条需求分析：在现有最近文件列表UI中添加删除功能。技术实现：两种方式1）列表项添加删除按钮；2）右键菜单提供删除选项。需要处理删除后的数据更新、列表刷新、列表重排序（如按使用时间排序）。难度：简单（UI添加+数据操作）。依赖：需求2（最近文件列表基础）。

---

### 第1条第4条原始需求

1）原始需求4描述：左侧列表可以折叠和展开

2）厘清的需求4描述：v2.0.0没有实现左侧列表的折叠展开功能，这是一个新需求。当前只有tab切换功能（目录/最近文件切换），不存在侧边栏的收起/展开功能。需要新增此功能。

3）本条需求分析：当前MMR v2.0.0只有tab切换（目录/最近文件），左侧边栏无法收起/展开。需要新增侧边栏折叠展开功能。技术要点：调整布局，增加折叠按钮（如左侧边缘的箭头按钮）；处理折叠/展开时的界面自适应（中间内容区域宽度变化）。难度：中等（UI布局调整）。依赖：需求15（界面改造统一设计）。

---

### 第1条第5条原始需求

1）原始需求5描述：需要增加显示版本历史新增或者删减，改变的功能信息

2）厘清的需求5描述：主界面顶部需要调整为菜单栏布局，菜单栏上显示当前最新版本号，版本号后面添加一个方向箭头按钮。点击该按钮弹出对话框，显示所有历史版本的历史更新信息。查看完成后点击"取消"返回主界面。版本历史就是软件版本变更的changelog信息，仅以文字形式展示变更内容。

3）本条需求分析：需要在主界面顶部新增菜单栏，包含版本号显示和版本历史按钮。版本历史采用弹窗模态框形式展示changelog文字信息。技术要点：1）UI改造：顶部菜单栏布局；2）版本号管理：内部版本历史数据存储（JSON文件或嵌入式数据库）；3）弹窗显示：模态框（dialog）组件，展示changelog文字列表。难度：中等（UI设计+数据存储）。依赖：需求15（界面改造关联）。

---

### 第1条第6条原始需求

1）原始需求6描述：调试信息窗口改成按钮开关查看

2）厘清的需求6描述：新增按钮控制显示/隐藏。补充：当前调试信息窗口已有展开折叠功能，默认是展开状态，可以改为默认关闭。目前调试框一直显示存在，对一般用户必要性不大。调试信息窗口是针对调试特别难的问题使用。功能优先级较低：对一般用户必要性不大，可以放到3.0或4.0版本实现。

3）本条需求分析：调试窗口已有展开折叠功能，需要改为默认关闭状态，并添加按钮控制显示/隐藏。技术要点：默认状态改为折叠；新增按钮（可能放在工具栏或设置中）；控制调试窗口的显示/隐藏逻辑。优先级：低（用户提到可放到3.0或4.0版本）。难度：简单（添加按钮+状态控制）。依赖：无。

---

### 第1条第6.1条原始需求

1）原始需求6.1描述：现在的MMR好像几个地方输出log或者错误查看信息，是不是可以合并在一起？比如就是log日志文件是不是可以呢？当然也可以分几个也可以的看侧重点怎么分配

2）厘清的需求6.1描述：调研合并log输出位置。理解正确。

3）本条需求分析：调研当前系统中各个输出日志信息的分散情况，思考如何整合到一个统一的日志查看位置（可能是界面上的log面板或独立日志文件）。技术要点：日志源调研（控制台输出、文件日志、界面调试信息）；合并方案设计（选择合并到统一位置或分级别分类）。分析阶段工作，不涉及具体编码。难度：简单（调研工作）。依赖：无。

---

### 第1条第7条原始需求

1）原始需求7描述：MD文档支持图片功能

2）厘清的需求7描述：MD `![]()` → HTML `<img>`。补充说明：遇到过某个MD文件，不知道如何具体嵌入图片。可能存在特殊的图片语法或格式还不清楚，需要调研常见的MD图片嵌入方式。

3）本条需求分析：支持Markdown图片语法，转换为HTML `<img>` 标签。技术要点：1）标准语法：`![alt](path)`；2）HTML标签：`<img src="path">`；3) Base64编码；4) 图片路径处理（相对路径、绝对路径、网络图片）。用户提到遇到过嵌入问题，需要调研并支持多种常见方式。难度：简单（Markdown解析扩展）。依赖：无。

---

### 第1条第8条原始需求

1）原始需求8描述：office的导出功能中，代码片段没有显示正确

2）厘清的需求8描述：Office导出功能有多个问题，最重要的是两个：1) 代码片段显示问题：代码不换行，都凑在一行了；2) 表格导出问题：导出后不是铺满页宽，而是一列一个字符宽度。其他问题后续再修改。

3）本条需求分析：修复Office导出代码格式问题。最优先的两个问题：1) 代码片段不换行 → 修复为正常格式（每行一句代码）；2) 表格不铺满页宽 → 修复为正常格式（表格宽度自适应或铺满页宽）。技术要点：排查export.go中Office导出代码；修复代码格式化逻辑；修复表格渲染逻辑。难度：中等（需要理解现有导出代码）。依赖：需要读代码排查具体问题位置。

---

### 第1条第9条原始需求

1）原始需求9描述：支持复制到剪切板的操作，支持我要发表文章给其他的比如头条，知乎，CSDN平台，微博

2）厘清的需求9描述：目标平台的编辑器都是富文本编辑器。要求：复制过去的文本内容要完全正常，格式漂亮。可能是HTML复制（带格式的HTML），但用户说不能确定。核心要求：用户不需要做任何修改编辑，就可以直接提交发布。图片可能是难点，后续再研究。优先级规划：需求9.1的接口实现比较麻烦，先实现需求9（剪切板操作），然后再考虑（讨论）需求9.1（自动发送接口）。

3）本条需求分析：提供剪切板复制功能，支持文本/图片/HTML多种格式。目标平台：知乎、CSDN、头条、微博等富文本编辑器。核心要求：复制内容格式漂亮，用户无需修改可直接发布。技术要点：1）多格式支持（文本、图片、HTML）；2) 剪切板API调用；3) HTML格式化代码样式；4) 图片剪贴板（作为难点，可后续研究）。优先级：需求9优先实现，需求9.1作为后续任务。难度：中等（多格式剪贴板）。依赖：无。

---

### 第1条第9.1条原始需求

1）原始需求9.1描述：能不能支持通过接口去自动发送给他们呢

2）厘清的需求9.1描述：使用各平台Official API。MMR内置发送功能。优先级规划：需求9.1的接口实现比较麻烦，先实现需求9（剪切板操作），然后再考虑（讨论）需求9.1（自动发送接口）的实现。

3）本条需求分析：自动化发送到知乎、微博、CSDN、头条等平台。技术要点：1) 使用各平台Official API；2) 申请API Key/Token认证；3) 实现API调用模块；4) 设置界面配置认证信息。优先级：需求9实现后再讨论，作为独立功能增强。难度：高（多平台API集成）。依赖：需求9（剪切板操作作为基础）。

---

### 第1条第10条原始需求

1）原始需求10描述：支持源码显示，需要显示行号

2）厘清的需求10描述：源码模式：左侧行号+右侧代码。理解正确。

3）本条需求分析：在源码显示模式下，提供代码行号显示功能。技术要点：1）源码模式切换逻辑；2）左侧行号+右侧代码的双栏布局；3）行号与代码的同步滚动。难度：简单（布局调整+行号渲染）。依赖：无。

---

### 第1条第11条原始需求

1）原始需求11描述：在解析mermaid出错的提示框，的存留时间值要缩短

2）厘清的需求11描述：调整自动关闭时间。补充：提示框停留时间需要在设置页面中作为可配置的设置项。

3）本条需求分析：缩短Mermaid解析错误提示框的自动关闭时间，并在设置页面中作为可配置项。技术要点：1）调整错误提示框的持续时间参数；2) 设置页面新增"提示框停留时间"配置项（如默认2-3秒，用户可调整）；3) 应用设置项到提示框逻辑。难度：简单（参数调整+设置页面配置）。依赖：需求2（设置功能关联）。

---

### 第1条第12条原始需求

1）原始需求12描述：现在的出错信息我看有，出错提示框可以查看错误信息。预览页底部有错误信息，但是只是提供了解析mermaid的错误信息是不是还有其他类型调试板信息的类似log日志的文件显示？这三者之间有什么异同

2）厘清的需求12描述：保留3个位置。①提示框：给普通用户看，弹框时间缩短（需求11），不增加展开详细错误功能（已确认不需要）；②调试信息板（右下角可折叠）：观察程序运行流程（调试难点MD文件时），不要太详细也不能太简单；③log文件：程序在debug状态下记录详细错误信息，供开发者查看分析，自动化测试时非常重要。

3）本条需求分析：明确3个位置的分工和定位。三个位置保留，不做整合。定位：1）提示框：面向普通用户，紧急错误，时间短；2）调试信息板：面向用户，观察运行流程，可折叠，位于渲染窗口右下角；3) log文件：面向开发者，详细调试信息，自动化测试重要依据。技术要点：不涉及新的开发，只是明确三个位置的职责和配置。难度：无（仅澄清，不开发）。依赖：无。

---

### 第1条第13条原始需求

1）原始需求13描述：增加编辑功能，保存为MD或者txt格式

2）厘清的需求13描述：新增编辑器，保存MD/TXT。补充说明：这是一个新建文本内容的功能，提供编辑界面让用户输入内容。保存格式以TXT为主（因为用户经常打开TXT文档查看、输入新内容、保存），也支持保存为MD格式。

3）本条需求分析：新增编辑功能，提供编辑界面让用户新建文本内容，支持保存为TXT（主要）和MD（可选）格式。技术要点：1）新增编辑器UI（文本输入区+保存按钮）；2) 文件选择对话框（保存位置和格式）；3) 文件写入逻辑（MD/TXT格式支持）。用户使用场景：经常打开TXT文档查看、输入新内容、保存。难度：中等（新增编辑器UI+文件操作）。依赖：无。

---

### 第1条第14条原始需求

1）原始需求14描述：是否可以支持word和PDF的阅读显示功能呢？

2）厘清的需求14描述：新增渲染引擎。理解正确。

3）本条需求分析：新增Word和PDF文件的阅读显示功能。技术要点：1) PDF渲染：引入pdf.js或类似库；2) Word渲染：引入mammoth.js或其他库解析Word文档；3) 文件类型识别：根据扩展名选择渲染方式；4) UI适配：支持多文件格式显示的布局调整。难度：高（引入新渲染引擎库，PDF和Word解析较复杂）。依赖：无。

---

### 第1条第15条原始需求

1）原始需求15描述：界面需要做一下改变，需要怎么改变适应新的需求

2）厘清的需求15描述：在分析完所有17个需求后，统一设计适合的新界面布局。既需要为新增功能添加按钮和布局空间，也需要重新设计整体界面的布局和风格。

3）本条需求分析：界面改造时机：分析完成后统一设计。设计内容包括：1) 功能层面：为新增功能（刷新、剪切板、编辑、设置等）添加对应的按钮和交互区域；2) 设计层面：重新设计整体布局，使其更合理、美观、易用。技术要点：整体UI/UX设计，涉及菜单栏（需求5）、工具栏、侧边栏（需求4折叠）、各种新增按钮的布局规划。难度：高（需要全面的UI/UX设计）。依赖：所有需求分析完成后进行，整合新增功能到统一设计中。

---

### 第1条第16条原始需求

1）原始需求16描述：MD文件的内容更新了，MMRreader能不能及时感知和主动刷新内容渲染新的内容呢，换一个方法有刷新按钮支持用户主动刷新也是可以的，或者两种方法都支持最好

2）厘清的需求16描述：支持在MD文件内容更新后及时刷新渲染显示新的内容。可通过文件监听机制自动检测文件变化并刷新，或者提供一个刷新按钮让用户手动刷新。最佳方案是同时支持这两种方式（自动监听+手动刷新按钮）。

3）本条需求分析：支持MD文件更新后刷新渲染，最好同时支持自动监听和手动刷新。技术要点：1）文件监听：实现文件变化检测机制（如定时检查或文件系统事件监听）；2) 刷新按钮：UI添加刷新按钮，手动触发重新读取和渲染；3) 自动刷新逻辑：检测到文件修改后自动刷新内容。优先级：两种方式都支持最佳。难度：中等（文件监听+刷新逻辑）。依赖：无。

---

### 第1条第17条原始需求

1）原始需求17描述：在进行MMR新版本开发的时候，问题修改和功能增加修改，能否支持自动执行全自动化测试呢？读取MD样例文件，检查显示是否正确？如果是修正错误问题，能否自动检测新修改后错误问题是否已改正？

2）厘清的需求17描述：样例来源3种：1) 一般功能验证时：使用case库文件；2) 修复具体MD文件错误时：用户提供了出错MD文件作为测试样例；3) 进行单元测试时：开发者可以根据需求自己创建测试case。测试方式：内建测试模式（不是Playwright端到端测试，因为MMR是Windows桌面APP，使用独立窗口系统）。测试触发时机：功能/Bug修复完成后，build新版本后自动运行自动化测试。要求：诚实！不能弄虚作假，必须如实报告测试结果。

3）本条需求分析：实现MMR内置的自动化测试功能，读取样例文件并自动检查显示结果是否正确。测试样例来源：1) 项目内置case库；2) 用户指定的MD文件；3) 开发者自定义测试用例。测试触发：新版本build后自动执行。技术要点：1) 内置测试引擎（解析MD样例文件并验证结果）；2) 自动化执行流程（build后触发）；3) 测试结果验证逻辑；4) 测试报告生成。核心要求：诚实！如实报告测试结果，遇到问题可向用户求助。难度：高（内置测试引擎设计、自动化流程集成）。依赖：所有需求完成后进行验收测试。

---



**更新时间**: 2026-02-14 06:26:58
