# OmniAgentAst. 开发优先级计划

**基于**: 需求沟通记录文档  
**策略**: Web端先行，桌面客户端后续  
**版本**: v1.0  
**创建时间**: 2026-02-15 21:55:00

---

## 第一阶段：Web端核心功能（MVP）

### 阶段目标
搭建Web端基础框架，实现核心ReAct循环和基础工具，验证AI模型调用和工具执行能力。

---

### 1.1 基础架构搭建

#### 1.1.1 后端基础
- [ ] 初始化Python项目结构
- [ ] 搭建Flask/FastAPI框架
- [ ] 配置CORS支持（前后端通信）
- [ ] 设计API路由结构
- [ ] 实现基础健康检查接口

#### 1.1.2 前端基础
- [ ] 初始化React项目（Vite）
- [ ] 配置基础UI组件库
- [ ] 设计主界面布局（聊天窗口形式）
- [ ] 实现前后端通信层（Axios/Fetch）
- [ ] 配置开发环境（热更新、代理）

#### 1.1.3 项目配置
- [ ] 创建requirements.txt（Python依赖）
- [ ] 创建package.json（前端依赖）
- [ ] 配置.gitignore
- [ ] 创建README.md（项目说明）

---

### 1.2 AI模型接入

#### 1.2.1 智谱GLM集成
- [ ] 封装智谱AI API调用
- [ ] 实现对话接口（chat/completions）
- [ ] 配置API Key管理（开发阶段明文）
- [ ] 实现基础对话功能（发送/接收消息）
- [ ] 错误处理和降级逻辑

#### 1.2.2 模型切换机制（简化版）
- [ ] 设计模型配置接口
- [ ] 实现智谱GLM为主模型
- [ ] 预留Claude备选接口（暂不实现）

---

### 1.3 ReAct执行器实现（核心）

#### 1.3.1 工具定义框架
- [ ] 设计工具定义Schema
- [ ] 实现工具注册机制
- [ ] 创建工具基类

#### 1.3.2 P0级工具实现（必须）
| 工具 | 功能 | 优先级 |
|------|------|--------|
| `read_file` | 读取文件内容 | P0 |
| `write_file` | 写入/创建文件 | P0 |
| `list_directory` | 列出目录内容 | P0 |
| `move_file` | 移动/重命名文件 | P0 |

#### 1.3.3 ReAct循环核心
- [ ] 实现思考-行动-观察循环
- [ ] 设计消息历史管理
- [ ] 实现工具调用解析
- [ ] 实现工具结果反馈
- [ ] 基础错误重试机制（3次）

---

### 1.4 对话界面实现（Web版）

**策略说明**：
- **先Web后桌面**：Web版便于快速测试和迭代，桌面版在Web版验收后开发
- **双版本核心功能一致**：对话、执行展示、历史管理完全相同
- **桌面版额外特性**：系统托盘、全局快捷键、窗口管理（见阶段1.5）

**核心功能（Web和桌面共用）**：
- 聊天消息展示（用户/AI气泡）
- 消息输入和发送
- 执行过程可视化（思考→行动→观察）
- 对话历史管理
- 左侧功能导航

**Web版特有**：
- 浏览器访问
- 响应式布局
- 基于Axios的HTTP通信

**桌面版特有**（见阶段1.5）：
- 系统托盘
- 全局快捷键
- Tauri IPC通信

#### 1.4.1 聊天界面（Web版）
- [ ] 消息列表展示（用户/AI）
- [ ] 输入框和发送按钮
- [ ] 消息气泡样式
- [ ] 加载状态提示
- [ ] 左侧功能导航栏（文件/系统/浏览器/知识库/设置）

#### 1.4.2 执行过程展示
- [ ] 显示AI思考过程（可折叠）
- [ ] 显示工具调用信息（工具名、参数、结果）
- [ ] 显示执行结果（成功/失败状态）
- [ ] 错误信息展示（友好提示）
- [ ] ReAct循环可视化（步骤时间线）

#### 1.4.3 基础交互
- [ ] 发送消息（Enter发送，Shift+Enter换行）
- [ ] 清空对话
- [ ] 复制消息内容
- [ ] 重新生成回复

---

### 1.5 对话界面实现（桌面版）

**开发前提**：Web版验收通过后
**技术栈**：Tauri (Rust) + React

#### 1.5.1 Tauri基础集成
- [ ] 初始化Tauri项目
- [ ] 配置Tauri与React集成
- [ ] 配置IPC通信（前后端）
- [ ] 窗口管理配置

#### 1.5.2 桌面特有功能
- [ ] 系统托盘图标和右键菜单
- [ ] 全局快捷键（Ctrl+Shift+O唤醒）
- [ ] 窗口最小化到托盘
- [ ] 开机自启动（可选）
- [ ] 单实例运行（防止多开）

#### 1.5.3 功能复用
- [ ] 复用Web版所有UI组件
- [ ] 复用对话逻辑
- [ ] 复用执行过程展示
- [ ] 适配Tauri IPC通信

---

### 1.6 配置管理

#### 1.6.1 后端配置
- [ ] 创建config.yaml结构
- [ ] 实现配置读取接口
- [ ] AI模型配置（智谱GLM）
- [ ] 安全配置（Shell命令黑白名单）

#### 1.6.2 前端配置界面
- [ ] 基础设置面板
- [ ] API Key输入（开发阶段）
- [ ] 模型选择下拉框

---

### 1.7 安全与错误处理

#### 1.7.1 命令安全
- [ ] 实现Shell命令黑名单
- [ ] 危险操作识别
- [ ] 用户确认机制（危险操作弹窗）

#### 1.7.2 错误处理
- [ ] 全局错误捕获
- [ ] 友好的错误提示
- [ ] 日志记录机制

---

## 第二阶段：功能增强与P1工具

### 阶段目标
扩展工具集，增强功能，提升用户体验。

---

### 2.1 P1级工具实现

| 工具 | 功能 | 场景 |
|------|------|------|
| `list_windows` | 列出所有窗口 | 窗口管理 |
| `switch_window` | 切换到指定窗口 | 窗口管理 |
| `screenshot` | 截图当前屏幕/窗口 | 系统控制 |
| `run_shell` | 执行shell命令（受限） | 系统控制 |
| `create_directory` | 创建文件夹 | 文件管理 |
| `delete_file` | 删除文件（需确认） | 文件管理 |

---

### 2.2 Planner规划器（简化版）

- [ ] 实现简单任务分解
- [ ] 生成执行计划展示
- [ ] 用户确认机制
- [ ] 计划执行进度展示

---

### 2.3 对话历史管理

- [ ] SQLite数据库设计
- [ ] 会话创建和保存
- [ ] 历史会话列表
- [ ] 会话恢复功能

---

### 2.4 P2级工具（可选）

- [ ] `clipboard_read` - 读取剪贴板
- [ ] `clipboard_write` - 写入剪贴板
- [ ] `get_system_info` - 获取系统信息

---

## 第三阶段：桌面客户端包装

### 阶段目标
将Web端用Tauri打包为桌面应用，增加系统级功能。

---

### 3.1 Tauri基础集成

- [ ] 初始化Tauri项目
- [ ] 配置Tauri与React集成
- [ ] 配置IPC通信
- [ ] 打包测试

---

### 3.2 系统级功能

- [ ] 系统托盘图标
- [ ] 全局快捷键（Ctrl+Shift+O）
- [ ] 窗口最小化到托盘
- [ ] 开机自启动（可选）

---

### 3.3 Python后端打包

- [ ] 选择打包方案（PyInstaller/内嵌Python）
- [ ] 配置后端自动启动
- [ ] 前后端一体化打包

---

### 3.4 安装与发布

- [ ] Windows安装程序（.msi/.exe）
- [ ] 自动更新机制（可选）
- [ ] 安装文档

---

## 第四阶段：高级功能（后续规划）

### 4.1 Refiner优化器
- [ ] 失败检测机制
- [ ] AI自动分析和修复
- [ ] 用户协助模式

### 4.2 浏览器自动化
- [ ] 网页打开和点击
- [ ] 表单自动填写
- [ ] 网页内容提取

### 4.3 知识库功能
- [ ] 文档导入和解析
- [ ] 向量索引
- [ ] 语义搜索

### 4.4 多模型支持
- [ ] Claude备选模型集成
- [ ] 智能切换逻辑
- [ ] 模型性能对比

---

## 开发原则

1. **阶段内优先级**
   - 必须先完成前一阶段再进入下一阶段
   - 阶段内按P0→P1→P2顺序实现

2. **验证驱动**
   - 每个功能实现后立即测试验证
   - 确保核心流程跑通再扩展

3. **渐进增强**
   - 先做能用的，再做好用的
   - 避免过度设计

---

**更新记录**:
- 2026-02-15 21:55:00 - 初始版本，基于需求沟通文档创建

---

*本文档描述开发优先级和阶段规划，不设定具体时间节点，根据实际进度推进。*
