# OmniAgentAst. 开发优先级计划

**基于**: 需求沟通记录文档  
**策略**: Web端先行，桌面客户端后续  
**版本**: v1.1
**创建时间**: 2026-02-15 21:55:00
**最后更新**: 2026-02-17 20:20:00

---

## 第一阶段：集成构建（基础核心）✅ 已完成

### 阶段目标
搭建后端基础框架，实现核心ReAct循环和基础工具，验证AI模型调用和工具执行能力。

**里程碑**: 后端API核心功能可用 ✅

---

### 1.1 基础架构搭建 ✅ 已完成

#### 1.1.1 后端基础
- [x] 初始化Python项目结构
- [x] 搭建FastAPI框架
- [x] 配置CORS支持（前后端通信）
- [x] 设计API路由结构
- [x] 实现基础健康检查接口

#### 1.1.2 前端基础
- [x] 初始化React项目（Vite）
- [x] 配置基础UI组件库
- [x] 设计主界面布局（聊天窗口形式）
- [x] 实现前后端通信层（Axios/Fetch）
- [x] 配置开发环境（热更新、代理）

#### 1.1.3 项目配置
- [x] 创建requirements.txt（Python依赖）
- [x] 创建package.json（前端依赖）
- [x] 配置.gitignore
- [x] 创建README.md（项目说明）

---

### 1.2 AI模型接入 ✅ 已完成

#### 1.2.1 智谱GLM集成
- [x] 封装智谱AI API调用
- [x] 实现对话接口（chat/completions）
- [x] 配置API Key管理（开发阶段明文）
- [x] 实现基础对话功能（发送/接收消息）
- [x] 错误处理和降级逻辑

#### 1.2.2 多模型支持 ✅ 已完成
- [x] 实现智谱GLM为主模型（glm-4.7-flash）
- [x] 实现OpenCode备选模型（kimi-k2.5-free）
- [x] 配置切换机制

> **注意**: 多模型支持已在P1.2完成，非第三阶段任务。

---

### 1.3 ReAct执行器实现 ✅ 已完成

#### 1.3.1 工具定义框架
- [x] 设计工具定义Schema
- [x] 实现工具注册机制
- [x] 创建工具基类

#### 1.3.2 P0级工具实现
| 工具 | 功能 | 状态 |
|------|------|------|
| `read_file` | 读取文件内容 | ✅ |
| `write_file` | 写入/创建文件 | ✅ |
| `list_directory` | 列出目录内容 | ✅ |
| `move_file` | 移动/重命名文件 | ✅ |
| `delete_file` | 删除文件 | ✅ |
| `search_files` | 搜索文件 | ✅ |

#### 1.3.3 ReAct循环核心
- [x] 实现思考-行动-观察循环
- [x] 设计消息历史管理
- [x] 实现工具调用解析
- [x] 实现工具结果反馈
- [x] 基础错误重试机制（3次）

---

## 第二阶段：Web产品化 🟡 进行中

### 阶段目标
完成Web版对话界面，实现配置管理，安全增强、功能扩展，达到浏览器可完整使用的状态。

**里程碑**: 浏览器可完整使用Web应用

---

### 2.1 Web对话界面（进行中）

**策略说明**：
- **先Web后桌面**：Web版便于快速测试和迭代
- **双版本核心功能一致**：对话，执行展示、历史管理完全相同
- **桌面版额外特性**：系统托盘、全局快捷键、窗口管理（见第三阶段）

#### 2.1.1 聊天界面（Web版）
- [ ] 消息列表展示（用户/AI）
- [ ] 输入框和发送按钮
- [ ] 消息气泡样式
- [ ] 加载状态提示
- [ ] 左侧功能导航栏（文件/系统/浏览器/知识库/设置）

#### 2.1.2 执行过程展示
- [ ] 显示AI思考过程（可折叠）
- [ ] 显示工具调用信息（工具名、参数、结果）
- [ ] 显示执行结果（成功/失败状态）
- [ ] 错误信息展示（友好提示）
- [ ] ReAct循环可视化（步骤时间线）

#### 2.1.3 基础交互
- [ ] 发送消息（Enter发送，Shift+Enter换行）
- [ ] 清空对话
- [ ] 复制消息内容
- [ ] 重新生成回复

---

### 2.2 Web配置管理 ⏸️ 待启动

#### 2.2.1 后端配置 ✅ 已完成
- [x] 创建config.yaml结构
- [x] 实现配置读取接口
- [x] AI模型配置（智谱GLM + OpenCode）
- [x] 安全配置

#### 2.2.2 前端配置界面
- [ ] 基础设置面板
- [ ] API Key输入界面
- [ ] 模型选择下拉框（智谱GLM / OpenCode）

---

### 2.3 Web安全增强 ⏸️ 待启动

#### 2.3.1 后端安全（部分完成）
- [x] 全局错误捕获
- [x] 友好的错误提示
- [x] 日志记录机制

#### 2.3.2 待完成
- [ ] Shell命令黑名单机制
- [ ] 危险操作识别
- [ ] 危险操作弹窗确认（前端）

---

### 2.4 P1级工具 ⏸️ 待启动

| 工具 | 功能 | 场景 |
|------|------|------|
| `list_windows` | 列出所有窗口 | 窗口管理 |
| `switch_window` | 切换到指定窗口 | 窗口管理 |
| `screenshot` | 截图当前屏幕/窗口 | 系统控制 |
| `run_shell` | 执行shell命令（受限） | 系统控制 |
| `create_directory` | 创建文件夹 | 文件管理 |
| `delete_file` | 删除文件（需确认） | 文件管理 |

---

### 2.5 对话历史管理 ⏸️ 待启动

- [ ] SQLite数据库设计
- [ ] 会话创建和保存
- [ ] 历史会话列表
- [ ] 会话恢复功能

---

### 2.6 P2级工具（可选）

- [ ] `clipboard_read` - 读取剪贴板
- [ ] `clipboard_write` - 写入剪贴板
- [ ] `get_system_info` - 获取系统信息

---

## 第三阶段：桌面化 + 高级功能

### 阶段目标
将Web版打包为桌面应用，增加系统级功能，并扩展高级特性。

**里程碑**: 桌面应用发布安装包

---

### 3.1 Tauri集成 ⏸️ 待启动

- [ ] 初始化Tauri项目
- [ ] 配置Tauri与React集成
- [ ] 配置IPC通信（前后端）
- [ ] 窗口管理配置

---

### 3.2 系统托盘/快捷键 ⏸️ 待启动

- [ ] 系统托盘图标和右键菜单
- [ ] 全局快捷键（Ctrl+Shift+O唤醒）
- [ ] 窗口最小化到托盘
- [ ] 开机自启动（可选）
- [ ] 单实例运行（防止多开）

---

### 3.3 Python后端打包 ⏸️ 待启动

- [ ] 选择打包方案（PyInstaller/内嵌Python）
- [ ] 配置后端自动启动
- [ ] 前后端一体化打包

---

### 3.4 安装程序 ⏸️ 待启动

- [ ] Windows安装程序（.msi/.exe）
- [ ] 自动更新机制（可选）
- [ ] 安装文档

---

### 3.5 Planner规划器 ⏸️ 待启动

- [ ] 实现简单任务分解
- [ ] 生成执行计划展示
- [ ] 用户确认机制
- [ ] 计划执行进度展示

---

### 3.6 Refiner优化器 ⏸️ 待启动

- [ ] 失败检测机制
- [ ] AI自动分析和修复
- [ ] 用户协助模式

---

### 3.7 浏览器自动化 ⏸️ 待启动

- [ ] 网页打开和点击
- [ ] 表单自动填写
- [ ] 网页内容提取

---

### 3.8 知识库 ⏸️ 待启动

- [ ] 文档导入和解析
- [ ] 向量索引
- [ ] 语义搜索

---

## 开发原则

1. **阶段内优先级**
   - 必须先完成前一阶段再进入下一阶段
   - 阶段内按P0→P1→P2顺序实现

2. **验证驱动**
   - 每个功能实现后立即测试验证
   - 确保核心流程跑通再扩展

3. **渐进增强**
   - 先做能用的，再做好用的
   - 避免过度设计

4. **日志记录 ⭐ 重要**
   - 每个新功能开发时必须同步添加日志记录
   - 遵循现有日志分层：logger_agent / logger_tool / logger_api
   - 避免事后抓瞎，出了错无法排查

---

**更新记录**:

| 日期 | 更新内容 | 更新人 |
|------|---------|--------|
| 2026-02-15 21:55:00 | 初始版本 v1.0，基于需求沟通文档创建 | AI助手小欧 |
| 2026-02-17 20:20:00 | 重构为3阶段方案 v1.1：第一阶段集成构建、第二阶段Web产品化、第三阶段桌面化+高级功能；修正多模型支持已在P1.2完成；添加日志记录开发原则 | AI助手小欧 |

---

*本文档描述开发优先级和阶段规划，不设定具体时间节点，根据实际进度推进。*
